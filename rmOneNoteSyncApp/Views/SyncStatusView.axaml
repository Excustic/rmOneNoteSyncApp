<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:rmOneNoteSyncApp.ViewModels"
             x:Class="rmOneNoteSyncApp.Views.SyncStatusView"
             x:DataType="vm:SyncStatusViewModel">
    
    <ScrollViewer Padding="30" HorizontalScrollBarVisibility="Disabled">
        <StackPanel Spacing="20">
            <TextBlock Classes="section-title" Text="Sync Status"/>
            
            <!-- Server Status Card -->
            <Border Background="White" CornerRadius="8" BoxShadow="0 2 10 0 #10000000" Padding="20">
                <Grid ColumnDefinitions="*,Auto">
                    <StackPanel Grid.Column="0" Spacing="10">
                        <TextBlock Text="Sync Server" FontSize="18" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <Ellipse Width="10" Height="10">
                                <Ellipse.Fill>
                                    <SolidColorBrush Color="{Binding IsServerRunning, 
                                        Converter={StaticResource BoolToStatusColorConverter}}"/>
                                </Ellipse.Fill>
                            </Ellipse>
                            <TextBlock Text="{Binding ServerStatus}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="10">
                        <Button Content="Start Server" 
                                Command="{Binding StartServerCommand}"
                                IsVisible="{Binding !IsServerRunning}"
                                Classes="primary"/>
                        <Button Content="Stop Server" 
                                Command="{Binding StopServerCommand}"
                                IsVisible="{Binding IsServerRunning}"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Statistics Cards -->
            <Grid ColumnDefinitions="*,*,*,*" ColumnSpacing="20">
                <Border Grid.Column="0" Background="White" CornerRadius="8" 
                        BoxShadow="0 2 10 0 #10000000" Padding="15">
                    <StackPanel>
                        <TextBlock Text="Received" Foreground="#666" FontSize="12"/>
                        <TextBlock Text="{Binding TotalReceived}" 
                                   FontSize="28" FontWeight="Bold" Foreground="#3b82f6"/>
                    </StackPanel>
                </Border>
                
                <Border Grid.Column="1" Background="White" CornerRadius="8" 
                        BoxShadow="0 2 10 0 #10000000" Padding="15">
                    <StackPanel>
                        <TextBlock Text="Pending" Foreground="#666" FontSize="12"/>
                        <TextBlock Text="{Binding TotalPending}" 
                                   FontSize="28" FontWeight="Bold" Foreground="#f59e0b"/>
                    </StackPanel>
                </Border>
                
                <Border Grid.Column="2" Background="White" CornerRadius="8" 
                        BoxShadow="0 2 10 0 #10000000" Padding="15">
                    <StackPanel>
                        <TextBlock Text="Uploaded" Foreground="#666" FontSize="12"/>
                        <TextBlock Text="{Binding TotalUploaded}" 
                                   FontSize="28" FontWeight="Bold" Foreground="#10b981"/>
                    </StackPanel>
                </Border>
                
                <Border Grid.Column="3" Background="White" CornerRadius="8" 
                        BoxShadow="0 2 10 0 #10000000" Padding="15">
                    <StackPanel>
                        <TextBlock Text="Failed" Foreground="#666" FontSize="12"/>
                        <TextBlock Text="{Binding TotalFailed}" 
                                   FontSize="28" FontWeight="Bold" Foreground="#ef4444"/>
                    </StackPanel>
                </Border>
            </Grid>
            
            <!-- Action Buttons and Progress -->
            <Border Background="White" CornerRadius="8" BoxShadow="0 2 10 0 #10000000" Padding="20">
                <Grid RowDefinitions="Auto,Auto" RowSpacing="15">
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="10">
                        <Button Content="Process Queue" 
                                Command="{Binding ProcessQueueCommand}"
                                IsEnabled="{Binding !IsSyncing}"
                                Classes="primary"/>
                        <Button Content="Retry Failed" 
                                Command="{Binding RetryFailedCommand}"
                                IsEnabled="{Binding !IsSyncing}"/>
                        <Button Content="Clear Completed" 
                                Command="{Binding ClearCompletedCommand}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Row="1" IsVisible="{Binding IsSyncing}">
                        <TextBlock Text="{Binding SyncProgress}" Margin="0,0,0,5"/>
                        <ProgressBar IsIndeterminate="True" Height="4"/>
                    </StackPanel>
                </Grid>
            </Border>
            
            <!-- Recent Files Table -->
            <Border Background="White" CornerRadius="8" BoxShadow="0 2 10 0 #10000000" Padding="20">
                <StackPanel>
                    <TextBlock Text="Recent Files" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,15"/>
                    
                    <DataGrid ItemsSource="{Binding SyncItems}"
                              AutoGenerateColumns="False"
                              CanUserReorderColumns="True"
                              CanUserResizeColumns="True"
                              GridLinesVisibility="Horizontal"
                              BorderThickness="0"
                              MinHeight="300"
                              MaxHeight="500">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Status" 
                                                Binding="{Binding StatusDisplay}" 
                                                Width="100"/>
                            <DataGridTextColumn Header="Notebook" 
                                                Binding="{Binding Notebook}" 
                                                Width="150"/>
                            <DataGridTextColumn Header="Section" 
                                                Binding="{Binding Section}" 
                                                Width="150"/>
                            <DataGridTextColumn Header="Page" 
                                                Binding="{Binding PageName}" 
                                                Width="*"/>
                            <DataGridTextColumn Header="Size" 
                                                Binding="{Binding FileSize}" 
                                                Width="80"/>
                            <DataGridTextColumn Header="Received" 
                                                Binding="{Binding ReceivedTime, StringFormat='{}{0:HH:mm:ss}'}" 
                                                Width="100"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>